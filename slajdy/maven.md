% Building tools


# Intro

## Need of building tool

Recap: manual compilation:

```
javac src/com/company/*.java
```

Manual command-line JAR packaging: 

```
jar cf HelloWorld.jar src/com/company/*.class
```
Manual command-line JAR packaging with manifest: 

```
jar cfe HelloWorld.jar com.company.Main ./*
```


<!--
Let's

https://www.baeldung.com/java-create-jar

-->


# Scripting

## Bash/Batch scripts


## Makefiles


# Apache Ant

![](maven-apache-ant-logo.svg)

## Apache Ant - intro

Software tool for automating software build processes which originated from the Apache Tomcat project
 in early 2000. 
 
Replacement for the `Make` build tool of Unix, and was created due to a number of problems with Unix's make.

It is similar to `Make` but is implemented using the Java language, requires the Java platform, 
and is best suited to building Java projects. 

----

Sample `build.xml` - ANT build file:

<div style="font-size: 70%">

```
<project>

    <target name="clean">
        <delete dir="ant-build"/>
    </target>

    <target name="compile">
        <mkdir dir="ant-build/classes"/>
        <javac srcdir="src" destdir="ant-build/classes"/>
    </target>

    <target name="jar">
        <mkdir dir="ant-build/jar"/>
        <jar destfile="ant-build/jar/HelloWorld.jar" basedir="ant-build/classes">
            <manifest>
                <attribute name="Main-Class" value="com.company.Main"/>
            </manifest>
        </jar>
    </target>

    <target name="run">
        <java jar="ant-build/jar/HelloWorld.jar" fork="true"/>
    </target>

</project>

```
</div>

Usage: `ant clean compile jar run`

<a href="https://ant.apache.org/manual/tutorial-HelloWorldWithAnt.html" target="_blank">more</a>



# ![](maven_white.svg)


## Maven - intro

Maven addresses two aspects of building software: 

* how software is built
 
* software dependencies

* it uses conventions for the build procedure 

## Packages / Artifacts

```
groupId
artifactId
version
```


## Repositories

* Local

* Remote

## Features


* Superior dependency management including automatic updating, dependency closures (also known as transitive dependencies)

* A large and growing repository of libraries and metadata to use out of the box, and arrangements in place with
 the largest Open Source projects for real-time availability of their latest releases



* Consistent usage across all projects (no ramp up time)



* Release management and distribution publication <!-- Without much additional configuration, 
Maven will integrate with your source control system (such as Subversion or Git)
 * manage the release of a project based on a certain tag. 
  * publish to a distribution location for use by other projects 
 Maven is able to publish individual outputs such as a JAR, an archive including other dependencies and documentation,
  or as a source distribution.

-->
  


* Able to easily work with multiple projects at the same time

---


* Extensible with plugins in Java or scripting languages

* Instant access to new features with little or no extra configuration

* Ant tasks for dependency management and deployment outside of Maven

* Model based builds: Maven is able to build any number of projects into predefined output types such as a JAR, WAR, 
or distribution based on metadata about the project, without the need to do any scripting in most cases.


## Reports and documentation

* Coherent site of project information: Using the same metadata as for the build process, Maven is able to generate 
a web site or PDF including 

    * any documentation you care to add, and adds to that standard 

    * reports about the state of development of the project.
 


## Dependency management

Maven encourages the use of a central repository of JARs and other dependencies.
 
 This allows users of Maven to reuse JARs across projects and encourages communication between projects to ensure that backward compatibility issues are dealt with.


## Benefits

* package management

* standard conventions and practices - to accelerate development cycle, while at the same time helping you achieve a higher rate of success.

* Simple project setup that follows best practices - get a new project or module started in seconds

# Let's go


## Install

Download from <a href="https://maven.apache.org/download.cgi" target="_blank">https://maven.apache.org/download.cgi</a>


```
mvn --version
```

## Maven install - task

* <a href="git-tasks.html#/zadanie-1" target="_blank">[Task 1]</a>



## Creating the project 

The initial project setup can be generated by Maven.
 
The simplest of Maven projects can be created with this simple command: 

<div style="font-size: 85%">
```
mvn archetype:generate                          \
-DarchetypeGroupId=org.apache.maven.archetypes  \
-DarchetypeArtifactId=maven-archetype-quickstart\
-DarchetypeVersion=1.4                          \
-DgroupId=com.mycompany                         \
-DartifactId=my-app
```
</div>


## Creating the project - task

* <a href="git-tasks.html#/zadanie-2" target="_blank">[Task 2]</a>
* <a href="git-tasks.html#/zadanie-3" target="_blank">[Task 3]</a>

## Project tree

```
|-- src
|   |-- main
|   |   |-- java
|   |       |-- com.mycompany
|   |           |-- App.java
|   |-- test
|       |-- java
|           |-- com.mycompany
|               |-- AppTest.java
|-- pom.xml
```

## Create project - tasks


# Maven CLI

## Syntax

```
mvn <phase>
```

```
mvn <plugin>:<phase>
```

## Compilation
```
mvn compile
```

## Compilation - task

* <a href="git-tasks.html#/zadanie-4" target="_blank">[Task 4]</a>

## Packaging

```
mvn package
```


## Packaging - task

* <a href="git-tasks.html#/zadanie-5" target="_blank">[Task 5]</a>

## Test

```
mvn test
```

## Installing to local repository 

```
mvn install
```

## Installing to local repository - task
* <a href="git-tasks.html#/zadanie-6" target="_blank">[Task 6]</a>


## Deploying to remote repository


This will deploy to configured Nexus repository:

```
mvn deploy
```

## Cleaning
    
```
mvn clean
```

## Cleaning - task

* <a href="git-tasks.html#/zadanie-7" target="_blank">[Task 7]</a>

## Sequence of phases and goals

E.g.
```
mvn <phase> <phase:goal> ...
``` 

## Chaining of commands 

* <a href="git-tasks.html#/zadanie-8" target="_blank">[Task 8]</a>

## Lifecycle summary

1. <em>Goal</em> - is the single unit of task which does some real work.

e.g. `mvn compiler:compile`

2. <em>Phase</em> - is a group of ordered goals.

e.g. `mvn compile`

3. <em>Build Lifecycle</em> - is a group of ordered phases 


## Lifecycle example


The lifecycle for the POM packaging `jar` includes the following phases:


`validate`
`initialize`
`generate-sources`
`process-sources`
`generate-resources`
`process-resources`
`compile`
`process-classes`
`generate-test-sourcess`
`process-test-sources`
`generate-test-resources`
`process-test-resources`
`test-compile`
`process-test-classes`
`test`
`prepare-package`
`package`
`pre-integration-test`
`integration-test`
`post-integration-test`
`verify`
`install`
`deploy`

Get it by: `mvn help:describe -Dcmd=compile`


## Maven CLI summary - task

* <a href="git-tasks.html#/zadanie-9" target="_blank">[Task 9]</a>

# Work with Dependencies

## Using java libraries - manually

For example, we want to calculate difference between two strings using <a href="https://en.wikipedia.org/wiki/Levenshtein_distance" target="_blank">Levenhstein distance</a> metric.

For this we would like to use 
<a href="https://commons.apache.org/proper/commons-text/javadocs/api-release/org/apache/commons/text/similarity/LevenshteinDistance.html">LevenshteinDistance</a>
class from `The Commons Text Package` by Apache.   

let's download 


<a href="https://commons.apache.org/proper/commons-text/userguide.html" target="_blank">apache.</a>

## Maven project in IDE

* <a href="git-tasks.html#/zadanie-10" target="_blank">[Task 10]</a>



## Using dependencies

In `dependencies` section:

```
<dependency>
    <groupId>commons-lang</groupId>
    <artifactId>commons-lang</artifactId>
    <version>2.6</version>
</dependency>
```

## Using dependencies - task

* <a href="git-tasks.html#/zadanie-10" target="_blank">[Task 10]</a>

## Our project as dependency

Only artifacts available in repository can be used as dependencies.
 
## Our project as dependency - task

* <a href="git-tasks.html#/zadanie-11" target="_blank">[Task 11]</a>



## Multi-module Maven project

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
		 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.company.multi</groupId>
    <artifactId>java-multi-modules</artifactId>
    <packaging>pom</packaging>
	<version>1.0</version>

	<modules>
        <module>core</module>
        <module>web</module>
        <module>utils</module>
    </modules>
	
</project>
```
## Multi-module Maven project - task

* <a href="git-tasks.html#/zadanie-12" target="_blank">[Task 12]</a>


# More Maven 

## Scopes

* `compile` (default) - Dependencies with this scope are available on the classpath of the project in all build tasks and they're propagated to the dependent projects.

```
<dependency>
    <groupId>commons-lang</groupId>
    <artifactId>commons-lang</artifactId>
    <version>2.6</version>
</dependency>
```

It is transitive.



##

* `provided` - this scope is used to mark dependencies that should be provided at runtime by JDK or a container

```
<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>servlet-api</artifactId>
    <version>2.5</version>
    <scope>provided</scope>
</dependency>
```


## 

* `runtime` - the dependencies with this scope are required at runtime, but they're not needed for compilation of the project code

```
<dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
    <version>6.0.6</version>
    <scope>runtime</scope>
</dependency>
```


##


* `test` - this scope is used to indicate that dependency isn't required at standard runtime of the application, but is used only for test purposes

```
<dependency>
    <groupId>junit</groupId>
    <artifactId>junit</artifactId>
    <version>4.12</version>
    <scope>test</scope>
</dependency>
```
It is not transitive


## Profiles

```
    <profiles>
      <profile>
        <activation>
          <property>
            <name>environment</name>
            <value>test</value>
          </property>
        </activation>
        ...
      </profile>
    </profiles>
```

```
mvn groupId:artifactId:goal -P profile-1,profile-2
```
More: [https://maven.apache.org/guides/introduction/introduction-to-profiles.html](https://maven.apache.org/guides/introduction/introduction-to-profiles.html)

## Plugins

E.g. generate Java classes from XML XSD.

```
       <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>jaxb2-maven-plugin</artifactId>
       </plugin>
```

More: [https://www.mojohaus.org/jaxb2-maven-plugin/Documentation/v2.2/example_xjc_basic.html](https://www.mojohaus.org/jaxb2-maven-plugin/Documentation/v2.2/example_xjc_basic.html)


# <img src="maven-gradle-white.svg" style="width: 70%" />

## Install

Download from: 
[https://gradle.org/releases/](https://gradle.org/releases/)

Verify: `gradle --version`

## Install - task

* <a href="git-tasks.html#/zadanie-13" target="_blank">[Task 13]</a>

## Create project

```
gradle init
```

## Create project - task

* <a href="git-tasks.html#/zadanie-14" target="_blank">[Task 14]</a>

<!--
```
compile 'com.company:site-core:1.0-SNAPSHOT'
``` -->

# Continuous Integration

## what why

https://www.katalon.com/resources-center/blog/benefits-continuous-integration-delivery/

https://dzone.com/articles/9-bene-ts-of-continuous-integration

https://nevercode.io/blog/what-is-continuous-integration-and-how-to-benefit-from-it/

https://pantheon.io/blog/5-advantages-continuous-integration


## tools

https://code-maze.com/top-8-continuous-integration-tools/
https://www.guru99.com/top-20-continuous-integration-tools.html


## example: jenkins

https://jenkins.io/doc/book/pipeline/

https://jenkins.io/doc/tutorials/build-a-java-app-with-maven/
https://wiki.jenkins.io/display/JENKINS/Pipeline+Maven+Plugin
https://jenkins.io/blog/2017/02/07/declarative-maven-project/

![](jenkins2.svg)

## ci cd 

## some best practices 

https://www.digitalocean.com/community/tutorials/an-introduction-to-ci-cd-best-practices




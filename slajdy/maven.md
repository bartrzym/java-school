% ![](maven_white.svg)

<!--
## {data-background="https://upload.wikimedia.org/wikipedia/commons/0/0b/Maven_logo.svg"}

```
****  intro: bld manually
****    
.*** bld from cmdline
**** (np from ide
...* np with deps
****
*.     ant, gradle, CI

  **
****
```


-->




<!--

https://maven.apache.org/guides/getting-started/

https://maven.apache.org/guides/getting-started/maven-in-five-minutes.html




https://www.quora.com/Why-do-we-use-Maven-in-Java

https://stackoverflow.com/questions/10764576/why-do-we-need-maven-or-ant-if-we-already-have-eclipse



Dlaczego Maven jest fajny i przy większych projektach bez tego typu narzędzi nie można by wydajnie pracować. Wydajnie albo i stabilnie, powtarzalnie, bo narzędzia budowania mają tę zaletę, 



https://www.baeldung.com/java-create-jar
https://en.wikipedia.org/wiki/Java_Classloader#JAR_hell
https://dzone.com/articles/what-is-jar-hell
https://dzone.com/articles/jar-hell-made-easy
https://stackoverflow.com/questions/21108953/solving-a-jar-hell-with-maven

-->

# Intro

## Why need any building tool?
Recap: manual compilation


```
javac src\com\company\*.java
```

Manual commandline packaging. 

```
jar cf Example.jar src\com\company\*.class
```


<!--
Let's

https://www.baeldung.com/java-create-jar

-->

## Packages / Artifacts



```
groupId
artifactId
version
```


## Repositories

* Local

* Remote

## Features


* Superior dependency management including automatic updating, dependency closures (also known as transitive dependencies)

* A large and growing repository of libraries and metadata to use out of the box, and arrangements in place with
 the largest Open Source projects for real-time availability of their latest releases



* Consistent usage across all projects - means no ramp up time for new developers coming onto a project



* Release management and distribution publication: Without much additional configuration, 
Maven will integrate with your source control system (such as Subversion or Git)
 * manage the release of a project based on a certain tag.
  
  * publish to a distribution location for use by other projects 
 Maven is able to publish individual outputs such as a JAR, an archive including other dependencies and documentation,
  or as a source distribution.




* Able to easily work with multiple projects at the same time


* Extensible, with the ability to easily write plugins in Java or scripting languages

* Instant access to new features with little or no extra configuration
* Ant tasks for dependency management and deployment outside of Maven

* Model based builds: Maven is able to build any number of projects into predefined output types such as a JAR, WAR, 
or distribution based on metadata about the project, without the need to do any scripting in most cases.

* Coherent site of project information: Using the same metadata as for the build process, Maven is able to generate 
a web site or PDF including 
    * any documentation you care to add, and adds to that standard 
    * reports about the state of development of the project.
 


* Dependency management: Maven encourages the use of a central repository of JARs and other dependencies. Maven comes with a mechanism that your project's clients can use to download any JARs required for building your project from a central JAR repository much like Perl's CPAN. This allows users of Maven to reuse JARs across projects and encourages communication between projects to ensure that backward compatibility issues are dealt with.


## Benefits

* package management

* standard conventions and practices - to accelerate development cycle, while at the same time helping you achieve a higher rate of success.

* Simple project setup that follows best practices - get a new project or module started in seconds

# Let's go


## Install

Download from <a href="https://maven.apache.org/download.cgi" target="_blank">https://maven.apache.org/download.cgi</a>


```
mvn --version
```

## Maven install - task

* <a href="git-tasks.html#/zadanie-1" target="_blank">[Task 1]</a>



## Creating the project 

The initial project setup can be generated by Maven.
 
The simplest of Maven projects can be created with this simple command: 

<div style="font-size: 85%">
```
mvn archetype:generate                          \
-DarchetypeGroupId=org.apache.maven.archetypes  \
-DarchetypeArtifactId=maven-archetype-quickstart\
-DarchetypeVersion=1.4                          \
-DgroupId=com.mycompany                         \
-DartifactId=my-app
```
</div>


## Creating the project - task

* <a href="git-tasks.html#/zadanie-2" target="_blank">[Task 2]</a>
* <a href="git-tasks.html#/zadanie-3" target="_blank">[Task 3]</a>

## Project tree

```
|-- src
|   |-- main
|   |   |-- java
|   |       |-- com.mycompany
|   |           |-- App.java
|   |-- test
|       |-- java
|           |-- com.mycompany
|               |-- AppTest.java
|-- pom.xml
```

## Create project - tasks


# Maven CLI

## Syntax

```
mvn <goal>
```

```
mvn <plugin>:<goal>
```

## Compilation
```
mvn compile
```

## Compilation - task


## Packaging

```
mvn package
```


## Packaging - task

* <a href="git-tasks.html#/zadanie-3" target="_blank">[Task 3]</a>

## Test

```
mvn test
```

## Installing to local repository 

```
mvn install
```

## Installing to local repository - task
* <a href="git-tasks.html#/zadanie-4" target="_blank">[Task 4]</a>

## Deploying to remote repository


This will deploy to configured Nexus repository:

```
mvn deploy
```

## Cleaning
    
```
mvn clean
```

## Cleaning - task


* <a href="git-tasks.html#/zadanie-5" target="_blank">[Task 5]</a>

## Lifecycle summary

1. <em>Goal</em> - is the single unit of task which does some real work.
E.g. 

2. <em>Phase</em> - is a group of ordered goals.

3. <em>Build Lifecycle</em> - is a group of ordered phases 


## Lifecycle example


The lifecycle for the POM packaging `jar` includes the following phases:


`validate`
`initialize`
`generate-sources`
`process-sources`
`generate-resources`
`process-resources`
`compile`
`process-classes`
`generate-test-sourcess`
`process-test-sources`
`generate-test-resources`
`process-test-resources`
`test-compile`
`process-test-classes`
`test`
`prepare-package`
`package`
`pre-integration-test`
`integration-test`
`post-integration-test`
`verify`
`install`
`deploy`

You can get it by: `mvn help:describe -Dcmd=compile`


# Work with Dependencies

## Using java libraries

For example, we want to calculate difference between two strings using <a href="https://en.wikipedia.org/wiki/Levenshtein_distance" target="_blank">Levenhstein distance</a> metric.

For this we would like to use 
<a href="https://commons.apache.org/proper/commons-text/javadocs/api-release/org/apache/commons/text/similarity/LevenshteinDistance.html">LevenshteinDistance</a>
class from `The Commons Text Package` by Apache.   

let's download 


<a href="https://commons.apache.org/proper/commons-text/userguide.html" target="_blank">apache.</a>

## Maven project in IDE


## Using dependencies


## Our project as dependency



## Multi-module Maven project



# 

## Scopes

## Profiles

# Related tools


## Plugins

TODO

E.g. generate Java classes from XML XSD.

## ANT

Sample `build.xml` - ANT build file:

<div style="font-size: 30%">

```
<project>

    <target name="clean">
        <delete dir="build"/>
    </target>

    <target name="compile">
        <mkdir dir="build/classes"/>
        <javac srcdir="src" destdir="build/classes"/>
    </target>

    <target name="jar">
        <mkdir dir="build/jar"/>
        <jar destfile="build/jar/HelloWorld.jar" basedir="build/classes">
            <manifest>
                <attribute name="Main-Class" value="oata.HelloWorld"/>
            </manifest>
        </jar>
    </target>

    <target name="run">
        <java jar="build/jar/HelloWorld.jar" fork="true"/>
    </target>

</project>
```
</div>

Usage: `ant clean compile jar run`

<a href="https://ant.apache.org/manual/tutorial-HelloWorldWithAnt.html" target="_blank">more</a>

## Gradle

```
compile 'com.company:site-core:1.0-SNAPSHOT'
```

## Continuous Integration

![](jenkins2.svg)
